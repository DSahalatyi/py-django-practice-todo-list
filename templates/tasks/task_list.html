{% extends "base.html" %}
{% load crispy_forms_filters %}

{% block content %}
  <h1 class="d-flex justify-content-between">
    TODO list
    <a href="{% url 'tasks:task-create' %}" class="btn btn-primary link-to-page my-auto">
      Add task
    </a>
  </h1>
  <hr>
  {% for task in task_list %}
    <div class="d-flex justify-content-between">
        <h5 class="card-title my-auto">{{ task.content }}
          {% if task.is_done %}<strong class="text-success">Done</strong>
          {% else %}<strong class="text-danger strong">Not done</strong>
          {% endif %}
        </h5>
        <form method="post">
          {% csrf_token %}
          {% if task.is_done %}
            <input type="hidden" name="task_id" value="{{ task.id }}">
            <input type="hidden" name="action" value="undo">
            <input type="submit" class="btn btn-secondary my-auto" value="Undo">
          {% else %}
            <input type="hidden" name="task_id" value="{{ task.id }}">
            <input type="hidden" name="action" value="complete">
            <input type="submit" class="btn btn-success" value="Complete">
          {% endif %}
        </form>
    </div>
    <div class="my-auto">
        <small>Created: {{ task.created_at }}</small>
        <small class="text-danger">
          {% if task.deadline %}
            Deadline: {{ task.deadline }}
          {% endif %}
        </small>
    </div>
        {% if task.tags.count > 0 %}
          <p class="text-muted my-auto">Tags: {{ task.tags.all|join:" " }}</p>
        {% endif %}
        <a href="{% url "tasks:task-update" task.pk %}">Update</a>
        <a href="{% url "tasks:task-delete" task.pk %}">Delete</a>
    <hr>
  {% endfor %}
{% endblock %}
